{
  "hash": "1145b354edfc591a49855909d11ff6ac",
  "result": {
    "markdown": "---\ntitle: \"isoRelate\"\noutput: html_document\nauthor: \"Kirsty McCann\"\ndate: \"12 Dec 2023\"\n---\n\n\n\n\n<br/>\n<br/>\n\n## Summary sheet\n\n\n::: {.cell}\n::: {.cell-output-display}\n`````{=html}\n<table style=\"width:50%; \" class=\"table table-striped table-hover table-condensed\">\n<tbody>\n  <tr>\n   <td style=\"text-align:left;\"> Main use-cases </td>\n   <td style=\"text-align:left;\"> Identity-by-decent (IBD), IBD multiple infections, IBD networks and significance plots </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Authors </td>\n   <td style=\"text-align:left;\"> Lyndan Henden </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Latest version </td>\n   <td style=\"text-align:left;\"> v0.1.0 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> License </td>\n   <td style=\"text-align:left;\"> YEAR:2018 COPYRIGHT HOLDER: Lyndal Henden </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Website </td>\n   <td style=\"text-align:left;\"> https://github.com/bahlolab/isoRelate/ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Code repository </td>\n   <td style=\"text-align:left;\"> https://github.com/bahlolab/isoRelate/ </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Publication </td>\n   <td style=\"text-align:left;\"> https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1007279 </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Tutorial authors </td>\n   <td style=\"text-align:left;\"> Kirsty McCann </td>\n  </tr>\n  <tr>\n   <td style=\"text-align:left;\"> Tutorial date </td>\n   <td style=\"text-align:left;\"> 12-Dec-23 </td>\n  </tr>\n</tbody>\n</table>\n\n`````\n:::\n:::\n\n\n## Purpose\n\nThe *isoRelate* R package has been developed with the intention to perform pairwise identity by decent analysis on haploid recombining organisms in the presence of multiclonal infections using SNP genotype data, but can also be applicable to whole genome sequencing data.\n\n*isoRelate* uses a novel statistic that has been developed by inferred IBD status at genomic locations. This statistic is used to identify loci under positive selection and illustrate visually appealling relatedness networks as a means of exploring shared haplotypes within populations.\n\nAppropriate uses for *isoRelate*\n1. Estimate proportion of genome shared IBD between isolate pairs,\n2. Detect genomic regions that are identicial by decent between isolate pairs,\n3. IBD within multiple infections,\n4. Identify loci under positive selection,\n5. Develops networks and is visually appealing.\n\n*isoRelate* performs pairwise relatedness mapping on haploid isolates using a first order continuous time hidden Markov model (HMM).\nThose isolates with multiple infections where the infected individual is carrying multiple genetically distinct strains of the species may have multiplicity of infection (MOI) greater than 1, and isoRelate can analyze them using a diploid model, rather than a haploid model.\n\nThe IBD segments are calculated using the Viterbi algorithm, which finds the single most likely sequence of IBD states that could have generated the observed genotypic data. An alternative method to this is to calculate the posterior probability of IBD sharing, which calculates the probability of sharing 0, 1 or 2 alleles IBD at each SNP, given the genotypic data. Thus, in addition to the Viterbi algorithm, we provide a function to generate the average posterior probability of IBD sharing for each isolate pair, which is calculated as; \n\n$$avePostPr = \\frac{PostPr(IBD = 1)}{2} + PostPr(IBD = 2).$$\n\n## Data formats\n\nTo use this tool, *isoRelate* requires PED and MAP formats that contains unphased genotype data for SNPs. Previously, generated of ped and map files has not been adequately documented. This tutorial attempts to add additional steps to process vcf data into pedmap format for use in *isoRelate*.\n\nPlease note: indels will cause problems when running isoRelate!\n\nThe typical pedmap format is as follows:\n1. Family ID\n2. Isolate ID\n3. Paternal ID\n4. Maternal ID\n5. Multiplicity of infection (MOI) (1 = single infection or haploid, 2 = multiple infections or diploid)\n6. Phenotype (1=unaffected, 2=affected, 0=unknown)\n\nThe IDs are alphanumeric: the combination of family and isolate ID should uniquely identify a sample.\nColumns 7 onwards (white-space delimited) are the isolate genotypes for biallelic SNPs where the A and B alleles are coded as 1 and 2 respectively and missing genotypes are coded as 0. \nAll SNPs  must have two alleles specified and each allele should be in a separate column.\nFor single infections, genotypes should be specified as homozygous. \nEither Both alleles should be missing (i.e. 0) or neither. Column labels are not required.\n\nImportantly the paternal ID, maternal ID and phenotype columns are not used by isoRelate, however are required for completeness of the pedigree. For this tutorial, these columns have not been included.\n\nExamples of informative family IDs are the sample collection site or country, however family IDs can be the same as the isolate IDs.\n\nThe MAP file contains exactly 4 columns of information:\n1. Chromosome \n2. SNP identifier\n3. Genetic map distance (centi-Morgans or Morgans)\n4. Base-pair position\n\nwhere each row describes a single marker. \nGenetic map distances and base-pair positions are expected to be positive values. \nThe MAP file must be ordered by increasing chromosome genetic map distance. \nSNP identifiers can contain any characters except spaces or tabs; also, you should avoid * symbols in names. \nThe MAP file must contain as many markers as are in the PED file. Column labels are not required.\n\n## Existing resources\n\n- isoRelate vignettes - https://github.com/bahlolab/isoRelate/blob/master/vignettes/introduction.Rmd\n- Identity-by-descent analyses for measuring population dynamics and selection in recombining pathogens - https://journals.plos.org/plosgenetics/article?id=10.1371/journal.pgen.1007279\n\n## Citation\n\nBibTeX style citation. For an R package, you can get this using `citation(package = \"isoRelate\")`:\n\n```\n@Manual{,\n    title = {Identity-by-descent analyses for measuring population dynamics and selection in recombining pathogens},\n    author = {Lyndan Henden, Stuart Lee, Alyssa Barry, Melanie Bahlo},\n    note = {R package version 1.0.2},\n  }\n```\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/kePrint-0.0.1/kePrint.js\"></script>\n<link href=\"../../site_libs/lightable-0.0.1/lightable.css\" rel=\"stylesheet\" />\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}